<div id="widget-offers">
    <input type="text" class="form-control" placeholder="Filtrar por titulo" id="filter-by-title"/>
    <button class="btn btn-dark" onclick="loadOffers()">Actualizar</button>
    <div class="card-deck" id="offers-list">

    </div>
</div>
<script>
    window.history.pushState("", "", "/apiclient/client.html?w=offer");
    var offers;
    var interested;
    var offerTitle;

    function loadOffers() {
        $.ajax({
            url: URLbase + "/offers",
            type: "GET",
            data: {},
            dataType: "json",
            headers: {"token": token},
            success: function success(response) {
                interested = response.interested;
                offers = response.offers;
                updateOffersList(offers,interested);
            },
            error: function (error) {
                $("#main-container").load("widget-login.html");
            }
        });
    }

    function updateOffersList(offers,interested) {
        $("#offers-list").empty();
        for (var i = 0; i < offers.length; i++) {
            $("#offers-list").append(
                "<div className='card border-dark mb-3' style='max-width: 18rem;min-width: 18rem; '>" +
                "<div className='card-body'>" +
                "<img className='card-img-top' height='180' src='/images/Symbol.png' width='180'/>" +
                "<h3 className='card-title'>" + offers[i].price + " EUR</h3>" +
                "<h4 className='card-subtitle' id='titleFeatured'>" + offers[i].title + "</h4>" +
                "<p className='card-text'>" + offers[i].description + "</p>" +
                "<h6 className='card-link' id='date'>" + offers[i].date + "</h6>" +
                "<h6 className='card-link' id='author'>" + offers[i].author + "</h6>" +
                "<a id='createConversation' onclick=\"loadConversation('"+offers[i]._id+"','" + interested + "','" + offers[i].title+"')\"" + "<button class=\"btn btn-dark\">Establecer conversaci√≥n</button> </a>"+
                "</div>" +
                "</div>"
            )
        }
    }



    async function loadConversation(offerIdVal,interested,offerTitleVal){
        interestedEmail=interested;
        offerId=offerIdVal;
        offerTitle=offerTitleVal;
        $("#main-container").load("widget-conversation.html");
    }

    loadOffers();
</script>